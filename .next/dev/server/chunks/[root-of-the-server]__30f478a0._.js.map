{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 48, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivelinivanov/waliet/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\nimport { PrismaPg } from \"@prisma/adapter-pg\";\nimport { Pool } from \"pg\";\n\nconst globalForPrisma = globalThis as unknown as {\n  prisma: PrismaClient | undefined;\n};\n\nfunction createPrismaClient() {\n  const pool = new Pool({ connectionString: process.env.DATABASE_URL });\n  const adapter = new PrismaPg(pool);\n  return new PrismaClient({ adapter });\n}\n\nexport const prisma = globalForPrisma.prisma ?? createPrismaClient();\n\nif (process.env.NODE_ENV !== \"production\") {\n  globalForPrisma.prisma = prisma;\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;;;;;;AAEA,MAAM,kBAAkB;AAIxB,SAAS;IACP,MAAM,OAAO,IAAI,+JAAI,CAAC;QAAE,kBAAkB,QAAQ,GAAG,CAAC,YAAY;IAAC;IACnE,MAAM,UAAU,IAAI,mLAAQ,CAAC;IAC7B,OAAO,IAAI,gNAAY,CAAC;QAAE;IAAQ;AACpC;AAEO,MAAM,SAAS,gBAAgB,MAAM,IAAI;AAEhD,wCAA2C;IACzC,gBAAgB,MAAM,GAAG;AAC3B"}},
    {"offset": {"line": 82, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivelinivanov/waliet/lib/supabase/server.ts"],"sourcesContent":["import { createServerClient } from \"@supabase/ssr\";\nimport { cookies } from \"next/headers\";\nimport { Database } from \"./database.types\";\n\nexport async function createClient() {\n  const cookieStore = await cookies();\n\n  return createServerClient<Database>(\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\n    {\n      cookies: {\n        getAll() {\n          return cookieStore.getAll();\n        },\n        setAll(cookiesToSet) {\n          try {\n            cookiesToSet.forEach(({ name, value, options }) =>\n              cookieStore.set(name, value, options)\n            );\n          } catch {\n            // The `setAll` method was called from a Server Component.\n            // This can be ignored if you have middleware refreshing sessions.\n          }\n        },\n      },\n    }\n  );\n}\n"],"names":[],"mappings":";;;;AAAA;AAAA;AACA;;;AAGO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,sJAAO;IAEjC,OAAO,IAAA,2MAAkB,oKAGvB;QACE,SAAS;YACP;gBACE,OAAO,YAAY,MAAM;YAC3B;YACA,QAAO,YAAY;gBACjB,IAAI;oBACF,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,GAC5C,YAAY,GAAG,CAAC,MAAM,OAAO;gBAEjC,EAAE,OAAM;gBACN,0DAA0D;gBAC1D,kEAAkE;gBACpE;YACF;QACF;IACF;AAEJ"}},
    {"offset": {"line": 113, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivelinivanov/waliet/lib/whop-sdk.ts"],"sourcesContent":["import { Whop } from \"@whop/sdk\";\n\nif (!process.env.NEXT_PUBLIC_WHOP_APP_ID) {\n  throw new Error(\"NEXT_PUBLIC_WHOP_APP_ID is not set\");\n}\n\nif (!process.env.WHOP_API_KEY) {\n  throw new Error(\"WHOP_API_KEY is not set\");\n}\n\nexport const whopsdk = new Whop({\n  appID: process.env.NEXT_PUBLIC_WHOP_APP_ID,\n  apiKey: process.env.WHOP_API_KEY,\n  webhookKey: btoa(process.env.WHOP_WEBHOOK_SECRET || \"\"),\n});\n\n// Platform company ID for receiving payments and sending payouts\nexport const PLATFORM_COMPANY_ID = process.env.PLATFORM_COMPANY_ID;\n\n/**\n * Transfer funds from platform account to a user (seller payout)\n * Uses Whop's transfers API to move money from the platform's balance\n * to a seller's Whop wallet\n *\n * Note: The actual Whop SDK types may differ. This function uses any types\n * and should be updated when the actual API structure is confirmed.\n */\nexport async function createPayoutTransfer(params: {\n  recipientUserId: string;\n  amountCents: number;\n  description: string;\n  idempotencyKey: string;\n  metadata?: Record<string, string>;\n}): Promise<{ transferId: string; status: string }> {\n  if (!PLATFORM_COMPANY_ID) {\n    throw new Error(\"PLATFORM_COMPANY_ID is not set\");\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const response = await (whopsdk.transfers as any).create({\n    origin: PLATFORM_COMPANY_ID,\n    destination: params.recipientUserId,\n    amount_cents: params.amountCents,\n    currency: \"usd\",\n    description: params.description,\n    idempotency_key: params.idempotencyKey,\n    metadata: params.metadata,\n  });\n\n  return {\n    transferId: response.id,\n    status: response.status || \"pending\",\n  };\n}\n\n/**\n * Check the status of a transfer\n */\nexport async function getTransferStatus(\n  transferId: string\n): Promise<{ status: string; failureReason?: string }> {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const response = await (whopsdk.transfers as any).retrieve(transferId);\n\n  return {\n    status: response.status || \"unknown\",\n    failureReason:\n      response.status === \"failed\" ? response.failure_message : undefined,\n  };\n}\n\n/**\n * Create a checkout configuration for purchasing hours\n * Uses Whop's checkoutConfigurations API which creates a plan and returns\n * a checkout config that can be used with iframeSdk.inAppPurchase()\n */\nexport async function createCheckoutConfig(params: {\n  name: string;\n  amountCents: number;\n  currency: \"usd\";\n  metadata: Record<string, string>;\n  redirectUrl?: string;\n}): Promise<{ id: string; planId: string; purchaseUrl: string }> {\n  if (!PLATFORM_COMPANY_ID) {\n    throw new Error(\"PLATFORM_COMPANY_ID is not set\");\n  }\n\n  // Create checkout configuration with an inline plan\n  // Note: Whop's initial_price expects dollars, not cents\n  const response = await whopsdk.checkoutConfigurations.create({\n    plan: {\n      company_id: PLATFORM_COMPANY_ID,\n      currency: params.currency,\n      initial_price: params.amountCents / 100,\n      plan_type: \"one_time\",\n      title: params.name,\n      visibility: \"hidden\",\n      product: {\n        external_identifier: `waliet_hours_${Date.now()}`,\n        title: params.name,\n        business_type: \"coaching\",\n      },\n    },\n    metadata: params.metadata,\n    redirect_url: params.redirectUrl,\n  });\n\n  if (!response || !response.plan) {\n    throw new Error(\"Failed to create checkout configuration\");\n  }\n\n  return {\n    id: response.id,\n    planId: response.plan.id,\n    purchaseUrl: response.purchase_url,\n  };\n}\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;AAAA;;AAEA;;AAIA,IAAI,CAAC,QAAQ,GAAG,CAAC,YAAY,EAAE;IAC7B,MAAM,IAAI,MAAM;AAClB;AAEO,MAAM,UAAU,IAAI,4JAAI,CAAC;IAC9B,KAAK;IACL,QAAQ,QAAQ,GAAG,CAAC,YAAY;IAChC,YAAY,KAAK,QAAQ,GAAG,CAAC,mBAAmB,IAAI;AACtD;AAGO,MAAM,sBAAsB,QAAQ,GAAG,CAAC,mBAAmB;AAU3D,eAAe,qBAAqB,MAM1C;IACC,IAAI,CAAC,qBAAqB;QACxB,MAAM,IAAI,MAAM;IAClB;IAEA,8DAA8D;IAC9D,MAAM,WAAW,MAAM,AAAC,QAAQ,SAAS,CAAS,MAAM,CAAC;QACvD,QAAQ;QACR,aAAa,OAAO,eAAe;QACnC,cAAc,OAAO,WAAW;QAChC,UAAU;QACV,aAAa,OAAO,WAAW;QAC/B,iBAAiB,OAAO,cAAc;QACtC,UAAU,OAAO,QAAQ;IAC3B;IAEA,OAAO;QACL,YAAY,SAAS,EAAE;QACvB,QAAQ,SAAS,MAAM,IAAI;IAC7B;AACF;AAKO,eAAe,kBACpB,UAAkB;IAElB,8DAA8D;IAC9D,MAAM,WAAW,MAAM,AAAC,QAAQ,SAAS,CAAS,QAAQ,CAAC;IAE3D,OAAO;QACL,QAAQ,SAAS,MAAM,IAAI;QAC3B,eACE,SAAS,MAAM,KAAK,WAAW,SAAS,eAAe,GAAG;IAC9D;AACF;AAOO,eAAe,qBAAqB,MAM1C;IACC,IAAI,CAAC,qBAAqB;QACxB,MAAM,IAAI,MAAM;IAClB;IAEA,oDAAoD;IACpD,wDAAwD;IACxD,MAAM,WAAW,MAAM,QAAQ,sBAAsB,CAAC,MAAM,CAAC;QAC3D,MAAM;YACJ,YAAY;YACZ,UAAU,OAAO,QAAQ;YACzB,eAAe,OAAO,WAAW,GAAG;YACpC,WAAW;YACX,OAAO,OAAO,IAAI;YAClB,YAAY;YACZ,SAAS;gBACP,qBAAqB,CAAC,aAAa,EAAE,KAAK,GAAG,IAAI;gBACjD,OAAO,OAAO,IAAI;gBAClB,eAAe;YACjB;QACF;QACA,UAAU,OAAO,QAAQ;QACzB,cAAc,OAAO,WAAW;IAClC;IAEA,IAAI,CAAC,YAAY,CAAC,SAAS,IAAI,EAAE;QAC/B,MAAM,IAAI,MAAM;IAClB;IAEA,OAAO;QACL,IAAI,SAAS,EAAE;QACf,QAAQ,SAAS,IAAI,CAAC,EAAE;QACxB,aAAa,SAAS,YAAY;IACpC;AACF"}},
    {"offset": {"line": 204, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivelinivanov/waliet/lib/dual-auth.ts"],"sourcesContent":["import { headers, cookies } from \"next/headers\";\nimport { createClient } from \"./supabase/server\";\nimport { whopsdk } from \"./whop-sdk\";\nimport { prisma } from \"./prisma\";\n\nexport type AuthProvider = \"whop\" | \"supabase\";\n\nexport interface DualAuthUser {\n  id: string;\n  name: string | null;\n  email: string | null;\n  avatar: string | null;\n  provider: AuthProvider;\n  providerId: string; // The ID from the auth provider (whopUserId or supabase user id)\n}\n\nexport interface DualAuthResult {\n  user: DualAuthUser;\n  dbUser: {\n    id: string;\n    name: string | null;\n    avatar: string | null;\n    email: string | null;\n    sellerProfile: {\n      id: string;\n      hourlyRate: number;\n      bio: string | null;\n      tagline: string | null;\n      averageRating: number | null;\n      totalSessionsCompleted: number;\n      totalReviews: number;\n      isVerified: boolean;\n      isActive: boolean;\n    } | null;\n  };\n}\n\n/**\n * Get authenticated user from either Whop or Supabase\n * Tries Whop first (for in-app usage), then falls back to Supabase\n */\nexport async function getDualAuthUser(): Promise<DualAuthResult | null> {\n  // Try Whop auth first\n  const whopUser = await tryWhopAuth();\n  if (whopUser) {\n    console.log(\"[DualAuth] Authenticated via Whop:\", whopUser.userId);\n    const dbUser = await syncWhopUserToDatabase(whopUser);\n    return {\n      user: {\n        id: dbUser.id,\n        name: whopUser.name,\n        email: whopUser.email || null,\n        avatar: whopUser.profilePicUrl || null,\n        provider: \"whop\",\n        providerId: whopUser.userId,\n      },\n      dbUser,\n    };\n  }\n\n  // Try Supabase auth\n  const supabaseUser = await trySupabaseAuth();\n  if (supabaseUser) {\n    console.log(\"[DualAuth] Authenticated via Supabase:\", supabaseUser.id);\n    const dbUser = await syncSupabaseUserToDatabase(supabaseUser);\n    return {\n      user: {\n        id: dbUser.id,\n        name: supabaseUser.name,\n        email: supabaseUser.email,\n        avatar: supabaseUser.avatar,\n        provider: \"supabase\",\n        providerId: supabaseUser.id,\n      },\n      dbUser,\n    };\n  }\n\n  console.log(\"[DualAuth] No authentication found\");\n  return null;\n}\n\ninterface WhopUserData {\n  userId: string;\n  name: string | null;\n  username: string;\n  email?: string;\n  profilePicUrl?: string;\n}\n\nasync function tryWhopAuth(): Promise<WhopUserData | null> {\n  try {\n    const cookieStore = await cookies();\n\n    // Check if user explicitly logged out - skip ALL Whop auth\n    const loggedOutCookie = cookieStore.get(\"waliet-logged-out\");\n    const loggedOut = loggedOutCookie?.value === \"true\";\n\n    console.log(\"[DualAuth] waliet-logged-out cookie:\", loggedOutCookie?.value, \"| loggedOut:\", loggedOut);\n\n    if (loggedOut) {\n      console.log(\"[DualAuth] User logged out, skipping Whop auth\");\n      return null;\n    }\n\n    // In development, allow bypassing auth with DEV_WHOP_USER_ID\n    if (process.env.NODE_ENV === \"development\" && process.env.DEV_WHOP_USER_ID) {\n      const userId = process.env.DEV_WHOP_USER_ID;\n      const user = await whopsdk.users.retrieve(userId);\n      type ExtendedWhopUser = { email?: string };\n      const extendedUser = user as unknown as ExtendedWhopUser;\n      return {\n        userId,\n        name: user.name,\n        username: user.username,\n        email: extendedUser.email,\n        profilePicUrl: user.profile_picture?.url || undefined,\n      };\n    }\n\n    // Normal auth flow - verify token from headers\n    const headersList = await headers();\n    const whopToken = headersList.get(\"x-whop-user-token\");\n\n    if (!whopToken) {\n      return null;\n    }\n\n    const result = await whopsdk.verifyUserToken(headersList);\n    const user = await whopsdk.users.retrieve(result.userId);\n    type ExtendedWhopUser = { email?: string };\n    const extendedUser = user as unknown as ExtendedWhopUser;\n\n    return {\n      userId: result.userId,\n      name: user.name,\n      username: user.username,\n      email: extendedUser.email,\n      profilePicUrl: user.profile_picture?.url || undefined,\n    };\n  } catch {\n    return null;\n  }\n}\n\ninterface SupabaseUserData {\n  id: string;\n  email: string;\n  name: string | null;\n  avatar: string | null;\n}\n\nasync function trySupabaseAuth(): Promise<SupabaseUserData | null> {\n  try {\n    // Check if Supabase is configured\n    if (!process.env.NEXT_PUBLIC_SUPABASE_URL || !process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY) {\n      console.log(\"[DualAuth] Supabase not configured\");\n      return null;\n    }\n\n    const supabase = await createClient();\n    const { data: { user }, error } = await supabase.auth.getUser();\n\n    console.log(\"[DualAuth] Supabase auth check - user:\", user?.id, \"error:\", error?.message);\n\n    if (error || !user) {\n      return null;\n    }\n\n    return {\n      id: user.id,\n      email: user.email || \"\",\n      name: user.user_metadata?.full_name || user.user_metadata?.name || null,\n      avatar: user.user_metadata?.avatar_url || user.user_metadata?.picture || null,\n    };\n  } catch (e) {\n    console.log(\"[DualAuth] Supabase auth error:\", e);\n    return null;\n  }\n}\n\nasync function syncWhopUserToDatabase(whopUser: WhopUserData) {\n  const user = await prisma.user.upsert({\n    where: { whopUserId: whopUser.userId },\n    update: {\n      name: whopUser.name,\n      avatar: whopUser.profilePicUrl || null,\n      email: whopUser.email || undefined,\n    },\n    create: {\n      whopUserId: whopUser.userId,\n      name: whopUser.name,\n      avatar: whopUser.profilePicUrl || null,\n      email: whopUser.email || null,\n    },\n    include: {\n      sellerProfile: {\n        select: {\n          id: true,\n          hourlyRate: true,\n          bio: true,\n          tagline: true,\n          averageRating: true,\n          totalSessionsCompleted: true,\n          totalReviews: true,\n          isVerified: true,\n          isActive: true,\n        },\n      },\n    },\n  });\n\n  // Create seller profile if doesn't exist (everyone is a seller by default)\n  if (!user.sellerProfile) {\n    await prisma.sellerProfile.create({\n      data: {\n        userId: user.id,\n        hourlyRate: 0, // Default rate, user can set later\n        isActive: true,\n      },\n    });\n\n    // Fetch the updated user with seller profile\n    return prisma.user.findUniqueOrThrow({\n      where: { id: user.id },\n      include: {\n        sellerProfile: {\n          select: {\n            id: true,\n            hourlyRate: true,\n            bio: true,\n            tagline: true,\n            averageRating: true,\n            totalSessionsCompleted: true,\n            totalReviews: true,\n            isVerified: true,\n            isActive: true,\n          },\n        },\n      },\n    });\n  }\n\n  return user;\n}\n\nasync function syncSupabaseUserToDatabase(supabaseUser: SupabaseUserData) {\n  // For Supabase users, we use supabaseUserId field\n  // First check if user exists by supabaseUserId\n  const existing = await prisma.user.findUnique({\n    where: { supabaseUserId: supabaseUser.id },\n    include: {\n      sellerProfile: {\n        select: {\n          id: true,\n          hourlyRate: true,\n          bio: true,\n          tagline: true,\n          averageRating: true,\n          totalSessionsCompleted: true,\n          totalReviews: true,\n          isVerified: true,\n          isActive: true,\n        },\n      },\n    },\n  });\n\n  if (existing) {\n    // Update existing user\n    const user = await prisma.user.update({\n      where: { id: existing.id },\n      data: {\n        name: supabaseUser.name || existing.name,\n        avatar: supabaseUser.avatar || existing.avatar,\n        email: supabaseUser.email || existing.email,\n      },\n      include: {\n        sellerProfile: {\n          select: {\n            id: true,\n            hourlyRate: true,\n            bio: true,\n            tagline: true,\n            averageRating: true,\n            totalSessionsCompleted: true,\n            totalReviews: true,\n            isVerified: true,\n            isActive: true,\n          },\n        },\n      },\n    });\n\n    // Create seller profile if doesn't exist (everyone is a seller by default)\n    if (!user.sellerProfile) {\n      await prisma.sellerProfile.create({\n        data: {\n          userId: user.id,\n          hourlyRate: 0,\n          isActive: true,\n        },\n      });\n\n      return prisma.user.findUniqueOrThrow({\n        where: { id: user.id },\n        include: {\n          sellerProfile: {\n            select: {\n              id: true,\n              hourlyRate: true,\n              bio: true,\n              tagline: true,\n              averageRating: true,\n              totalSessionsCompleted: true,\n              totalReviews: true,\n              isVerified: true,\n              isActive: true,\n            },\n          },\n        },\n      });\n    }\n\n    return user;\n  }\n\n  // Create new user\n  const newUser = await prisma.user.create({\n    data: {\n      supabaseUserId: supabaseUser.id,\n      name: supabaseUser.name,\n      avatar: supabaseUser.avatar,\n      email: supabaseUser.email,\n    },\n  });\n\n  // Create seller profile for new user\n  await prisma.sellerProfile.create({\n    data: {\n      userId: newUser.id,\n      hourlyRate: 0,\n      isActive: true,\n    },\n  });\n\n  return prisma.user.findUniqueOrThrow({\n    where: { id: newUser.id },\n    include: {\n      sellerProfile: {\n        select: {\n          id: true,\n          hourlyRate: true,\n          bio: true,\n          tagline: true,\n          averageRating: true,\n          totalSessionsCompleted: true,\n          totalReviews: true,\n          isVerified: true,\n          isActive: true,\n        },\n      },\n    },\n  });\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 516, "column": 0}, "map": {"version":3,"sources":["file:///Users/ivelinivanov/waliet/app/api/app/home/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport { prisma } from \"@/lib/prisma\";\nimport { getDualAuthUser } from \"@/lib/dual-auth\";\nimport { subDays } from \"date-fns\";\n\nexport async function GET() {\n  try {\n    const auth = await getDualAuthUser();\n\n    if (!auth) {\n      return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\n    }\n\n    const userId = auth.dbUser.id;\n    const sellerProfile = auth.dbUser.sellerProfile;\n\n    const now = new Date();\n    const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());\n    const sevenDaysAgo = subDays(now, 7);\n    const fourteenDaysAgo = subDays(now, 14);\n\n    // Base user data\n    const userData = {\n      id: auth.dbUser.id,\n      name: auth.dbUser.name,\n      avatar: auth.dbUser.avatar,\n      email: auth.dbUser.email,\n    };\n\n    // If user has a seller profile, get seller-specific data\n    if (sellerProfile) {\n      // Get session stats\n      const [\n        completedSessions,\n        pendingRequests,\n        awaitingConfirmation,\n        inProgressSessions,\n        upcomingSessions,\n      ] = await Promise.all([\n        prisma.session.count({\n          where: {\n            sellerId: userId,\n            status: { in: [\"COMPLETED\", \"RATED\", \"PAID_OUT\"] },\n          },\n        }),\n        prisma.session.count({\n          where: {\n            sellerId: userId,\n            status: \"REQUESTED\",\n          },\n        }),\n        prisma.session.count({\n          where: {\n            sellerId: userId,\n            status: \"AWAITING_CONFIRMATION\",\n          },\n        }),\n        prisma.session.count({\n          where: {\n            sellerId: userId,\n            status: \"IN_PROGRESS\",\n          },\n        }),\n        prisma.session.findMany({\n          where: {\n            sellerId: userId,\n            status: { in: [\"ACCEPTED\", \"REQUESTED\"] },\n            scheduledAt: { gte: now },\n          },\n          include: {\n            buyer: { select: { id: true, name: true, avatar: true } },\n          },\n          orderBy: { scheduledAt: \"asc\" },\n          take: 5,\n        }),\n      ]);\n\n      // Calculate earnings from completed sessions\n      const completedSessionsData = await prisma.session.findMany({\n        where: {\n          sellerId: userId,\n          status: { in: [\"COMPLETED\", \"RATED\", \"PAID_OUT\", \"AWAITING_CONFIRMATION\"] },\n        },\n        select: {\n          pricePerUnit: true,\n          units: true,\n          status: true,\n          completedAt: true,\n          createdAt: true,\n        },\n      });\n\n      const totalEarnings = completedSessionsData\n        .filter((s) => [\"COMPLETED\", \"RATED\", \"PAID_OUT\"].includes(s.status))\n        .reduce((sum, s) => sum + (s.pricePerUnit || 0) * s.units, 0);\n\n      const pendingEarnings = completedSessionsData\n        .filter((s) => s.status === \"AWAITING_CONFIRMATION\")\n        .reduce((sum, s) => sum + (s.pricePerUnit || 0) * s.units, 0);\n\n      // Get pending payouts\n      const pendingPayouts = await prisma.payout.findMany({\n        where: {\n          sellerId: userId,\n          status: { in: [\"PENDING\", \"PROCESSING\"] },\n        },\n        select: { amount: true },\n      });\n      const pendingPayoutAmount = pendingPayouts.reduce((sum, p) => sum + p.amount, 0);\n\n      // Get earnings for last 7 days (for sparkline chart)\n      const recentEarnings = await prisma.session.findMany({\n        where: {\n          sellerId: userId,\n          status: { in: [\"COMPLETED\", \"RATED\", \"PAID_OUT\"] },\n          completedAt: { gte: sevenDaysAgo },\n        },\n        select: {\n          pricePerUnit: true,\n          units: true,\n          completedAt: true,\n        },\n      });\n\n      // Group earnings by day for sparkline\n      const earningsByDay: Record<string, number> = {};\n      for (let i = 6; i >= 0; i--) {\n        const date = subDays(now, i);\n        const dateKey = date.toISOString().slice(0, 10);\n        earningsByDay[dateKey] = 0;\n      }\n\n      for (const session of recentEarnings) {\n        if (session.completedAt) {\n          const dateKey = session.completedAt.toISOString().slice(0, 10);\n          if (earningsByDay[dateKey] !== undefined) {\n            earningsByDay[dateKey] += (session.pricePerUnit || 0) * session.units;\n          }\n        }\n      }\n\n      const earningsChart = Object.entries(earningsByDay).map(([date, amount]) => ({\n        date,\n        amount: amount / 100, // Convert cents to dollars\n      }));\n\n      // Calculate earnings change (this week vs last week)\n      const thisWeekEarnings = recentEarnings.reduce(\n        (sum, s) => sum + (s.pricePerUnit || 0) * s.units,\n        0\n      );\n\n      const lastWeekEarnings = await prisma.session.findMany({\n        where: {\n          sellerId: userId,\n          status: { in: [\"COMPLETED\", \"RATED\", \"PAID_OUT\"] },\n          completedAt: { gte: fourteenDaysAgo, lt: sevenDaysAgo },\n        },\n        select: { pricePerUnit: true, units: true },\n      });\n\n      const lastWeekTotal = lastWeekEarnings.reduce(\n        (sum, s) => sum + (s.pricePerUnit || 0) * s.units,\n        0\n      );\n\n      const earningsChange =\n        lastWeekTotal > 0\n          ? ((thisWeekEarnings - lastWeekTotal) / lastWeekTotal) * 100\n          : thisWeekEarnings > 0\n          ? 100\n          : 0;\n\n      // Get unique buyers count\n      const uniqueBuyers = await prisma.session.groupBy({\n        by: [\"buyerId\"],\n        where: {\n          sellerId: userId,\n          status: { in: [\"COMPLETED\", \"RATED\", \"PAID_OUT\"] },\n        },\n      });\n\n      // Get recent activity\n      const recentSessions = await prisma.session.findMany({\n        where: { sellerId: userId },\n        include: {\n          buyer: { select: { id: true, name: true, avatar: true } },\n        },\n        orderBy: { createdAt: \"desc\" },\n        take: 5,\n      });\n\n      const recentPurchases = await prisma.purchase.findMany({\n        where: { sellerId: userId },\n        include: {\n          buyer: { select: { id: true, name: true, avatar: true } },\n        },\n        orderBy: { createdAt: \"desc\" },\n        take: 5,\n      });\n\n      return NextResponse.json({\n        user: userData,\n        isSeller: true,\n        stats: {\n          totalEarnings: totalEarnings / 100,\n          pendingEarnings: pendingEarnings / 100,\n          pendingPayoutAmount: pendingPayoutAmount / 100,\n          totalSessions: completedSessions,\n          uniqueBuyers: uniqueBuyers.length,\n          averageRating: sellerProfile.averageRating,\n          totalReviews: sellerProfile.totalReviews,\n          hourlyRate: sellerProfile.hourlyRate / 100,\n        },\n        earningsChart,\n        earningsChange,\n        pendingActions: {\n          sessionRequests: pendingRequests,\n          awaitingConfirmation,\n          inProgress: inProgressSessions,\n          pendingPayouts: pendingPayouts.length,\n        },\n        upcomingSessions: upcomingSessions.map((s) => ({\n          id: s.id,\n          topic: s.topic,\n          scheduledAt: s.scheduledAt?.toISOString() || null,\n          status: s.status,\n          buyer: s.buyer,\n        })),\n        recentActivity: [\n          ...recentSessions.map((s) => ({\n            id: `session-${s.id}`,\n            type: \"session\" as const,\n            title:\n              s.status === \"REQUESTED\"\n                ? \"New session request\"\n                : s.status === \"COMPLETED\"\n                ? \"Session completed\"\n                : `Session ${s.status.toLowerCase().replace(\"_\", \" \")}`,\n            description: `${s.buyer?.name || \"Someone\"} - ${s.topic}`,\n            timestamp: s.createdAt.toISOString(),\n            status: s.status,\n          })),\n          ...recentPurchases.map((p) => ({\n            id: `purchase-${p.id}`,\n            type: \"purchase\" as const,\n            title: \"New purchase\",\n            description: `${p.buyer?.name || \"Someone\"} bought ${p.units} unit(s)`,\n            amount: p.sellerReceives / 100,\n            timestamp: p.createdAt.toISOString(),\n            status: p.status,\n          })),\n        ]\n          .sort((a, b) => new Date(b.timestamp).getTime() - new Date(a.timestamp).getTime())\n          .slice(0, 10),\n      });\n    }\n\n    // Non-seller user (buyer only)\n    const purchasesMade = await prisma.purchase.count({\n      where: { buyerId: userId },\n    });\n\n    const sessionsBooked = await prisma.session.count({\n      where: { buyerId: userId },\n    });\n\n    const totalSpent = await prisma.purchase.aggregate({\n      where: { buyerId: userId, status: \"COMPLETED\" },\n      _sum: { totalAmount: true },\n    });\n\n    return NextResponse.json({\n      user: userData,\n      isSeller: false,\n      stats: {\n        totalSpent: (totalSpent._sum.totalAmount || 0) / 100,\n        purchasesMade,\n        sessionsBooked,\n      },\n      pendingActions: {\n        sessionRequests: 0,\n        awaitingConfirmation: 0,\n        inProgress: 0,\n        pendingPayouts: 0,\n      },\n      earningsChart: [],\n      earningsChange: 0,\n      upcomingSessions: [],\n      recentActivity: [],\n    });\n  } catch (error) {\n    console.error(\"Error fetching home data:\", error);\n    return NextResponse.json(\n      { error: \"Failed to fetch home data\" },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":"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"}}]
}