(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,69310,56249,e=>{"use strict";var s=e.i(74760);e.i(44685);var t=e.i(84736);function r(){let e=(0,t.use)(s.WhopIframeSdkContext);if(!e)throw Error("useIframeSdk must be used within a WhopIframeSdkProvider");return e}e.s(["useIframeSdk",()=>r],56249),e.s([],69310)},8812,e=>{"use strict";var s=e.i(30098),t=e.i(84736),r=e.i(87943),a=e.i(83675),n=e.i(71058),i=e.i(63480);e.i(69310);var l=e.i(56249);function o({open:e,onOpenChange:o,seller:d,experienceId:c,companyId:u}){let m,[h,x]=(0,t.useState)(2),[j,p]=(0,t.useState)(!1),[f,g]=(0,t.useState)(null),N=(0,l.useIframeSdk)(),v=Math.round(d.hourlyRate/2)*h,y=Math.round(800*v/1e4),b=Math.round(500*v/1e4),w=v+y+b,S=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(e/100),k=async()=>{p(!0),g(null);try{let e=await fetch("/api/purchases/checkout/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sellerId:d.id,units:h,experienceId:c,companyId:u})}),s=await e.json();if(!e.ok)throw Error(s.error||"Failed to create checkout");if(!s.planId)throw Error("No plan ID returned");let t=await N.inAppPurchase({planId:s.planId,id:s.purchaseId});if("error"===t.status)throw Error(t.error||"Payment failed");o(!1),window.location.reload()}catch(e){g(e instanceof Error?e.message:"Something went wrong"),p(!1)}};return(0,s.jsx)(r.Dialog,{open:e,onOpenChange:o,children:(0,s.jsxs)(r.DialogContent,{size:"md",children:[(0,s.jsxs)(r.DialogHeader,{children:[(0,s.jsx)(r.DialogTitle,{children:"Buy Hours"}),(0,s.jsxs)(r.DialogDescription,{children:["Purchase time with ",d.name||"this seller"]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-muted/50 rounded-xl",children:[(0,s.jsxs)(n.Avatar,{className:"h-12 w-12",children:[(0,s.jsx)(n.AvatarImage,{src:d.avatar||void 0}),(0,s.jsx)(n.AvatarFallback,{children:d.name?.[0]?.toUpperCase()||"?"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium",children:d.name||"Seller"}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:[S(d.hourlyRate),"/hour"]})]})]}),(0,s.jsxs)("div",{className:"py-4",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-muted-foreground mb-3 block",children:"How much time do you want to buy?"}),(0,s.jsxs)("div",{className:"flex items-center justify-center gap-4",children:[(0,s.jsx)(a.Button,{variant:"outline",size:"icon",onClick:()=>{h>1&&x(h-1)},disabled:h<=1,children:(0,s.jsx)(i.MdRemove,{className:"h-4 w-4"})}),(0,s.jsxs)("div",{className:"text-center min-w-[120px]",children:[(0,s.jsx)("p",{className:"text-3xl font-bold",children:(m=h/2)<1?`${30*h} minutes`:1===m?"1 hour":`${m} hours`}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:[h," x 30-min units"]})]}),(0,s.jsx)(a.Button,{variant:"outline",size:"icon",onClick:()=>{h<20&&x(h+1)},disabled:h>=20,children:(0,s.jsx)(i.MdAdd,{className:"h-4 w-4"})})]})]}),(0,s.jsxs)("div",{className:"space-y-2 p-4 bg-muted/30 rounded-xl text-sm",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Subtotal"}),(0,s.jsx)("span",{children:S(v)})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Platform fee (8%)"}),(0,s.jsx)("span",{children:S(y)})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Community fee (5%)"}),(0,s.jsx)("span",{children:S(b)})]}),(0,s.jsxs)("div",{className:"border-t pt-2 mt-2 flex justify-between font-semibold text-base",children:[(0,s.jsx)("span",{children:"Total"}),(0,s.jsx)("span",{className:"text-primary",children:S(w)})]})]}),f&&(0,s.jsx)("p",{className:"text-sm text-destructive text-center",children:f}),(0,s.jsxs)(r.DialogFooter,{children:[(0,s.jsx)(a.Button,{variant:"outline",onClick:()=>o(!1),children:"Cancel"}),(0,s.jsx)(a.Button,{onClick:k,disabled:j,className:"gap-2",children:j?"Processing...":(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.MdShoppingCart,{className:"h-4 w-4"}),"Pay ",S(w)]})})]})]})})}e.s(["InAppBuyHoursModal",()=>o])},90114,e=>{e.n(e.i(8812))}]);